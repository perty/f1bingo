<!DOCTYPE html>
<html lang="sv">
<head>
    <title>Förarinformation</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/misc-info.css">
    <link href="https://fonts.googleapis.com/css?family=Syne&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/@stomp/stompjs@7.0.0/bundles/stomp.umd.min.js"></script>
</head>
<body>
<div class="container">
    <div id="chatPopup" style="display:none;" onclick="goToChatPage();">
        Nytt meddelande i chatten!
    </div>
    <div class="header">
        <div class="logo">
            <a href="/home.html" title="Gå till första sidan"><img src="/images/logo.png" alt="logo" id="logo"></a>
        </div>
        <div class="title shadow">
            <p>Förare</p>
        </div>
    </div>
    <div class="minor-title">
        <a href="/misc-info.html"><< Tillbaka</a>
    </div>
    <div class="content">
        <p id="stats">
            Medellängd: XXX cm<br/>
            Medelålder: XXX år
        </p>
        <p>
            Sortera genom att klicka på rubrikerna i tabellen.
        </p>
        <div class="one-column">
            <table id="driversTable">
                <thead>
                <tr>
                    <th onclick="sortTable(0)">Nr</th>
                    <th onclick="sortTable(1)">Förare</th>
                    <th>Född</th>
                    <th onclick="sortTable(3)">Ålder</th>
                    <th onclick="sortTable(4)">Längd</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td>14</td>
                    <td>ALONSO Fernando</td>
                    <td>29-jul-81</td>
                    <td></td>
                    <td>171 cm</td>
                </tr>
                <tr>
                    <td>23</td>
                    <td>ALBON Alex</td>
                    <td>23-mar-96</td>
                    <td></td>
                    <td>186 cm</td>
                </tr>
                <tr>
                    <td>50</td>
                    <td>BEARMAN Oliver</td>
                    <td>8-maj-05</td>
                    <td></td>
                    <td>184 cm</td>
                </tr>
                <tr>
                    <td>43</td>
                    <td>COLAPINTO Franco</td>
                    <td>27-maj-03</td>
                    <td></td>
                    <td>175 cm</td>
                </tr>
                <tr>
                    <td>77</td>
                    <td>BOTTAS Valtteri</td>
                    <td>29-aug-89</td>
                    <td></td>
                    <td>173 cm</td>
                </tr>
                <tr>
                    <td>10</td>
                    <td>GASLY Pierre</td>
                    <td>07-feb-96</td>
                    <td></td>
                    <td>177 cm</td>
                </tr>
                <tr>
                    <td>44</td>
                    <td>HAMILTON Lewis</td>
                    <td>07-jan-85</td>
                    <td></td>
                    <td>174 cm</td>
                </tr>
                <tr>
                    <td>27</td>
                    <td>HüLKENBERG Nico</td>
                    <td>19-aug-87</td>
                    <td></td>
                    <td>184 cm</td>
                </tr>
                <tr>
                    <td>30</td>
                    <td>LAWSON Liam</td>
                    <td>11-feb-02</td>
                    <td></td>
                    <td>174 cm</td>
                </tr>
                <tr>
                    <td>16</td>
                    <td>LECLERC Charles</td>
                    <td>16-okt-97</td>
                    <td></td>
                    <td>180 cm</td>
                </tr>
                <tr>
                    <td>20</td>
                    <td>MAGNUSSEN Kevin</td>
                    <td>05-okt-92</td>
                    <td></td>
                    <td>174 cm</td>
                </tr>
                <tr>
                    <td>4</td>
                    <td>NORRIS Lando</td>
                    <td>13-nov-99</td>
                    <td></td>
                    <td>170 cm</td>
                </tr>
                <tr>
                    <td>31</td>
                    <td>OCON Esteban</td>
                    <td>17-sep-96</td>
                    <td></td>
                    <td>186 cm</td>
                </tr>
                <tr>
                    <td>11</td>
                    <td>PEREZ Sergio</td>
                    <td>26-jan-90</td>
                    <td></td>
                    <td>173 cm</td>
                </tr>
                <tr>
                    <td>81</td>
                    <td>PIASTRI Oscar</td>
                    <td>06-apr-01</td>
                    <td></td>
                    <td>178 cm</td>
                </tr>
                <tr>
                    <td>3</td>
                    <td>RICCIARDO Daniel</td>
                    <td>31-jul-89</td>
                    <td></td>
                    <td>178 cm</td>
                </tr>
                <tr>
                    <td>63</td>
                    <td>RUSSEL George</td>
                    <td>15-feb-98</td>
                    <td></td>
                    <td>185 cm</td>
                </tr>
                <tr>
                    <td>55</td>
                    <td>SAINZ Carlos</td>
                    <td>01-sep-94</td>
                    <td></td>
                    <td>177 cm</td>
                </tr>
                <tr>
                    <td>2</td>
                    <td>SARGEANT Logan</td>
                    <td>31-dec-00</td>
                    <td></td>
                    <td>181 cm</td>
                </tr>
                <tr>
                    <td>18</td>
                    <td>STROLL Lance</td>
                    <td>29-okt-98</td>
                    <td></td>
                    <td>182 cm</td>
                </tr>
                <tr>
                    <td>22</td>
                    <td>TSUNODA Yuki</td>
                    <td>11-maj-00</td>
                    <td></td>
                    <td>159 cm</td>
                </tr>
                <tr>
                    <td>1</td>
                    <td>VERSTAPPEN Max</td>
                    <td>30-sep-97</td>
                    <td></td>
                    <td>181 cm</td>
                </tr>
                <tr>
                    <td>24</td>
                    <td>ZHOU Guanyu</td>
                    <td>30-maj-99</td>
                    <td></td>
                    <td>176 cm</td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>
<script>
    const monthMap = {
        'jan': 0, 'feb': 1, 'mar': 2, 'apr': 3,
        'maj': 4, 'jun': 5, 'jul': 6, 'aug': 7,
        'sep': 8, 'okt': 9, 'nov': 10, 'dec': 11
    };

let sortOrder = 1; // 1 för stigande, -1 för fallande
let lastSortedColumn = -1;

function sortTable(columnIndex) {
    const table = document.getElementById("driversTable");
    const rows = Array.from(table.rows).slice(1); // Exkludera rubrikraden
    const isNumericColumn = columnIndex === 0 || columnIndex === 3 || columnIndex === 4;

    if (lastSortedColumn === columnIndex) {
        sortOrder *= -1; // Växla sorteringsordningen
    } else {
        sortOrder = 1; // Återställ till stigande sortering
    }
    lastSortedColumn = columnIndex;

    rows.sort((rowA, rowB) => {
        const cellA = rowA.cells[columnIndex].textContent.trim();
        const cellB = rowB.cells[columnIndex].textContent.trim();

        if (isNumericColumn) {
            return (parseFloat(cellA) - parseFloat(cellB)) * sortOrder;
        } else {
            return cellA.localeCompare(cellB, 'sv') * sortOrder;
        }
    });

    // Återställ tabellens rader i sorterad ordning
    rows.forEach(row => table.tBodies[0].appendChild(row));
}

    document.addEventListener("DOMContentLoaded", function () {
        const tableRows = document.getElementById("driversTable").rows;
        const birthDateColumn = 2;
        const ageColumn = 3;
        const heightColumn = 4;
        let totalAge = 0;
        let totalHeight = 0;

        for (let i = 1; i < tableRows.length; i++) {
            const birthdateCell = tableRows[i].cells[birthDateColumn];
            const ageCell = tableRows[i].cells[ageColumn];
            const birthdate = convertSwedishDateStringToDate(birthdateCell.textContent);
            let age = calculateAge(birthdate);
            ageCell.textContent = age + "";
            totalAge += age;
            totalHeight += parseInt(tableRows[i].cells[heightColumn].textContent);
        }
        const averageAge = totalAge / (tableRows.length - 1);
        const averageHeight = totalHeight / (tableRows.length - 1);
        document.getElementById("stats").innerHTML = `Medellängd: ${averageHeight.toFixed(2)} cm<br/>Medelålder: ${averageAge.toFixed(1)} år`;

        function calculateAge(birthdate) {
            const today = new Date();
            let age = today.getFullYear() - birthdate.getFullYear();
            const m = today.getMonth() - birthdate.getMonth();
            if (m < 0 || (m === 0 && today.getDate() < birthdate.getDate())) {
                age--;
            }
            return age;
        }
    });

    function convertSwedishDateStringToDate(dateStr) {
        const parts = dateStr.split('-'); // Delar upp strängen vid varje '-'
        const day = parseInt(parts[0], 10);
        const monthCode = parts[1].toLowerCase(); // Konvertera till små bokstäver för matchning
        let year = parseInt(parts[2], 10) + 2000;
        if (year > new Date().getFullYear()) {
            year -= 100;
        }

        const month = monthMap[monthCode];
        if (month !== undefined) {
            return new Date(year, month, day);
        } else {
            console.error("Ogiltigt månadsnamn: " + monthCode);
            return null;
        }
    }

</script>
<script src="/js/chat-notification.js"></script>
</body>
</html>

